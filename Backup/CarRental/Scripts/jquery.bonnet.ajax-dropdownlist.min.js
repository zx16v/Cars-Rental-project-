/*!
 * jQuery Plugin MVC Select update ajax
 *
 * @date 01 aug 2013
 * @version: 1.0
 * @author Frank Bonnet
 *
 * @dependencies:
 *	jquery.min.js
 */
(function(e){var t={namespace:"bonnet.ajax.dropdownlist",version:"1.0"};var n={options:{id:t.namespace,events:{beforeUpdate:null,afterUpdate:null},disableWhenEmpty:false,target:null,url:null},_create:function(t){var n=this;n.setOptions(t);if(null===n.options.target){n.options.target=e(document.getElementById(n.element.attr("data-bonnet-ajax-update-target")))}if(null==n.options.url){n.options.url=n.element.attr("data-bonnet-ajax-update-url")}if(n.element.attr("data-bonnet-ajax-update-disable-target-when-empty")=="True"){n.options.disableWhenEmpty=true}n.element.change(function(){n.update.apply(n)})},setOptions:function(t){if("object"===typeof t){e.extend(true,this.options,t)}},getOptions:function(){return this.options},setOption:function(e,t){self.options[e]=t},getOption:function(e){return self.options.key},getVersion:function(){return t.version},update:function(){var t=this;if(typeof t.options.events.beforeUpdate==="function"){t.options.events.beforeUpdate.apply(t)}e.ajax({type:"POST",url:t.options.url,data:{Origin:t.element.attr("id"),Target:t.options.target.attr("id"),Value:t.element.val()},success:function(e){if(t.options.target.is("select")){t._updateSelect.apply(t,[e])}if(typeof t.options.events.afterUpdate==="function"){t.options.events.afterUpdate.apply(t,[e])}}})},_updateSelect:function(t){var n=this;if(typeof t==="object"){n.options.target.html("");e(t).each(function(){var t=e("<option>");t.val(this.Value);t.text(this.Text);if(this.Selected){t.attr("selected","selected")}if(this.Disabled){t.attr("disabled","disabled")}n.options.target.append(t)})}else{n.options.target.html(t)}if(n.options.disableWhenEmpty&&(t==null||typeof t.length==="undefined"||t.length==0||t.length==1&&t[0].Value=="")){n.options.target.attr("disabled","disabled")}else{n.options.target.removeAttr("disabled")}}};e.fn.BonnetAjaxUpdate=function(r){if(r instanceof String&&"_"==r.charAt(0)){return this}var i=this;var s=i;var o;if(!r||"object"===typeof r){i.each(function(){var r=e.data(this,t.namespace);if(!r){r=e.data(this,t.namespace,e.extend(true,{},new Object(n)));r.element=e(this)}s=r._create.apply(r,o)})}else if(n[r]){i.each(function(){var n=e.data(this,t.namespace);o=[].slice.call(o,1);s=n[r].apply(n,o)})}return s}})(jQuery);$(function(){$("[data-bonnet-ajax-update-enabled]").BonnetAjaxUpdate()})